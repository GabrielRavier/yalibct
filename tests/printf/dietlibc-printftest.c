#include <stdio.h>
#include <string.h>

char * format[] = {
  "%",
#ifndef YALIBCT_DISABLE_PRINTF_PRECISION_TESTS
  "%0.",
  "%.0",
  "%+0.",
  "%+.0",
  "%.5",
  "%+.5",
  "%2.5",
  "%22.5",
  "%022.5",
  "%#022.5",
  "%-#022.5",
  "%+#022.5",
  "%-22.5",
  "%+22.5",
  "%--22.5",
  "%++22.5",
  "%+-22.5",
  "%-+22.5",
  "%-#022.5",
  "%-#22.5",
  "%-2.22",
  "%+2.22",
  "%-#02.22",
  "%-#2.22",
  "%-1.5",
  "%1.5",
  "%-#01.5",
  "%-#1.5",
  "%-#.5",
  "%-#1.",
  "%-#.",
#endif
  NULL
};
 

static void
intchk (const char *fmt)
{
  (void) printf("%15s :, \"", fmt);
  (void) printf(fmt, 0);
  (void) printf("\", \"");
  (void) printf(fmt, 123);
  (void) printf("\", \"");
  (void) printf(fmt, -18);
  (void) printf("\"\n");
}

static void
fltchk (const char *fmt)
{
  (void) printf("%15s :, \"", fmt);
  (void) printf(fmt, 0.0);
  (void) printf("\", \"");
  (void) printf(fmt, 123.0001);
  (void) printf("\", \"");
  (void) printf(fmt, -18.0002301);
  (void) printf("\"\n");
}

int main()
{  
  char buf[256];
  int i;
  
  printf("%s\n\n", "# vim:syntax=off:");
  
  /* integers */
  for(i=0;format[i];i++) {
    strcpy(buf, format[i]);
    strcat(buf, "d");
    intchk(buf);
  }
#ifdef YALIBCT_DISABLE_PRINTF_PRECISION_TESTS
  puts("           %0.d :, \"\", \"123\", \"-18\"\n           %.0d :, \"\", \"123\", \"-18\"\n          %+0.d :, \"+\", \"+123\", \"-18\"\n          %+.0d :, \"+\", \"+123\", \"-18\"\n           %.5d :, \"00000\", \"00123\", \"-00018\"\n          %+.5d :, \"+00000\", \"+00123\", \"-00018\"\n          %2.5d :, \"00000\", \"00123\", \"-00018\"\n         %22.5d :, \"                 00000\", \"                 00123\", \"                -00018\"\n        %022.5d :, \"                 00000\", \"                 00123\", \"                -00018\"\n       %#022.5d :, \"                 00000\", \"                 00123\", \"                -00018\"\n      %-#022.5d :, \"00000                 \", \"00123                 \", \"-00018                \"\n      %+#022.5d :, \"                +00000\", \"                +00123\", \"                -00018\"\n        %-22.5d :, \"00000                 \", \"00123                 \", \"-00018                \"\n        %+22.5d :, \"                +00000\", \"                +00123\", \"                -00018\"\n       %--22.5d :, \"00000                 \", \"00123                 \", \"-00018                \"\n       %++22.5d :, \"                +00000\", \"                +00123\", \"                -00018\"\n       %+-22.5d :, \"+00000                \", \"+00123                \", \"-00018                \"\n       %-+22.5d :, \"+00000                \", \"+00123                \", \"-00018                \"\n      %-#022.5d :, \"00000                 \", \"00123                 \", \"-00018                \"\n       %-#22.5d :, \"00000                 \", \"00123                 \", \"-00018                \"\n        %-2.22d :, \"0000000000000000000000\", \"0000000000000000000123\", \"-0000000000000000000018\"\n        %+2.22d :, \"+0000000000000000000000\", \"+0000000000000000000123\", \"-0000000000000000000018\"\n      %-#02.22d :, \"0000000000000000000000\", \"0000000000000000000123\", \"-0000000000000000000018\"\n       %-#2.22d :, \"0000000000000000000000\", \"0000000000000000000123\", \"-0000000000000000000018\"\n         %-1.5d :, \"00000\", \"00123\", \"-00018\"\n          %1.5d :, \"00000\", \"00123\", \"-00018\"\n       %-#01.5d :, \"00000\", \"00123\", \"-00018\"\n        %-#1.5d :, \"00000\", \"00123\", \"-00018\"\n         %-#.5d :, \"00000\", \"00123\", \"-00018\"\n         %-#1.d :, \" \", \"123\", \"-18\"\n          %-#.d :, \"\", \"123\", \"-18\"");
#endif
  
  /* floats */
  for(i=0;format[i];i++) {
    strcpy(buf, format[i]);
    strcat(buf, "f");
    fltchk(buf);
  }
#ifdef YALIBCT_DISABLE_PRINTF_PRECISION_TESTS
  puts("           %0.f :, \"0\", \"123\", \"-18\"\n           %.0f :, \"0\", \"123\", \"-18\"\n          %+0.f :, \"+0\", \"+123\", \"-18\"\n          %+.0f :, \"+0\", \"+123\", \"-18\"\n           %.5f :, \"0.00000\", \"123.00010\", \"-18.00023\"\n          %+.5f :, \"+0.00000\", \"+123.00010\", \"-18.00023\"\n          %2.5f :, \"0.00000\", \"123.00010\", \"-18.00023\"\n         %22.5f :, \"               0.00000\", \"             123.00010\", \"             -18.00023\"\n        %022.5f :, \"0000000000000000.00000\", \"0000000000000123.00010\", \"-000000000000018.00023\"\n       %#022.5f :, \"0000000000000000.00000\", \"0000000000000123.00010\", \"-000000000000018.00023\"\n      %-#022.5f :, \"0.00000               \", \"123.00010             \", \"-18.00023             \"\n      %+#022.5f :, \"+000000000000000.00000\", \"+000000000000123.00010\", \"-000000000000018.00023\"\n        %-22.5f :, \"0.00000               \", \"123.00010             \", \"-18.00023             \"\n        %+22.5f :, \"              +0.00000\", \"            +123.00010\", \"             -18.00023\"\n       %--22.5f :, \"0.00000               \", \"123.00010             \", \"-18.00023             \"\n       %++22.5f :, \"              +0.00000\", \"            +123.00010\", \"             -18.00023\"\n       %+-22.5f :, \"+0.00000              \", \"+123.00010            \", \"-18.00023             \"\n       %-+22.5f :, \"+0.00000              \", \"+123.00010            \", \"-18.00023             \"\n      %-#022.5f :, \"0.00000               \", \"123.00010             \", \"-18.00023             \"\n       %-#22.5f :, \"0.00000               \", \"123.00010             \", \"-18.00023             \"\n        %-2.22f :, \"0.0000000000000000000000\", \"123.0001000000000033196557\", \"-18.0002300999999995667622\"\n        %+2.22f :, \"+0.0000000000000000000000\", \"+123.0001000000000033196557\", \"-18.0002300999999995667622\"\n      %-#02.22f :, \"0.0000000000000000000000\", \"123.0001000000000033196557\", \"-18.0002300999999995667622\"\n       %-#2.22f :, \"0.0000000000000000000000\", \"123.0001000000000033196557\", \"-18.0002300999999995667622\"\n         %-1.5f :, \"0.00000\", \"123.00010\", \"-18.00023\"\n          %1.5f :, \"0.00000\", \"123.00010\", \"-18.00023\"\n       %-#01.5f :, \"0.00000\", \"123.00010\", \"-18.00023\"\n        %-#1.5f :, \"0.00000\", \"123.00010\", \"-18.00023\"\n         %-#.5f :, \"0.00000\", \"123.00010\", \"-18.00023\"\n         %-#1.f :, \"0.\", \"123.\", \"-18.\"\n          %-#.f :, \"0.\", \"123.\", \"-18.\"");
#endif
  /* hexa */
  for(i=0;format[i];i++) {
    strcpy(buf, format[i]);
    strcat(buf, "x");
    intchk(buf);
  }
#ifdef YALIBCT_DISABLE_PRINTF_PRECISION_TESTS
  puts("           %0.x :, \"\", \"7b\", \"ffffffee\"\n           %.0x :, \"\", \"7b\", \"ffffffee\"\n          %+0.x :, \"\", \"7b\", \"ffffffee\"\n          %+.0x :, \"\", \"7b\", \"ffffffee\"\n           %.5x :, \"00000\", \"0007b\", \"ffffffee\"\n          %+.5x :, \"00000\", \"0007b\", \"ffffffee\"\n          %2.5x :, \"00000\", \"0007b\", \"ffffffee\"\n         %22.5x :, \"                 00000\", \"                 0007b\", \"              ffffffee\"\n        %022.5x :, \"                 00000\", \"                 0007b\", \"              ffffffee\"\n       %#022.5x :, \"                 00000\", \"               0x0007b\", \"            0xffffffee\"\n      %-#022.5x :, \"00000                 \", \"0x0007b               \", \"0xffffffee            \"\n      %+#022.5x :, \"                 00000\", \"               0x0007b\", \"            0xffffffee\"\n        %-22.5x :, \"00000                 \", \"0007b                 \", \"ffffffee              \"\n        %+22.5x :, \"                 00000\", \"                 0007b\", \"              ffffffee\"\n       %--22.5x :, \"00000                 \", \"0007b                 \", \"ffffffee              \"\n       %++22.5x :, \"                 00000\", \"                 0007b\", \"              ffffffee\"\n       %+-22.5x :, \"00000                 \", \"0007b                 \", \"ffffffee              \"\n       %-+22.5x :, \"00000                 \", \"0007b                 \", \"ffffffee              \"\n      %-#022.5x :, \"00000                 \", \"0x0007b               \", \"0xffffffee            \"\n       %-#22.5x :, \"00000                 \", \"0x0007b               \", \"0xffffffee            \"\n        %-2.22x :, \"0000000000000000000000\", \"000000000000000000007b\", \"00000000000000ffffffee\"\n        %+2.22x :, \"0000000000000000000000\", \"000000000000000000007b\", \"00000000000000ffffffee\"\n      %-#02.22x :, \"0000000000000000000000\", \"0x000000000000000000007b\", \"0x00000000000000ffffffee\"\n       %-#2.22x :, \"0000000000000000000000\", \"0x000000000000000000007b\", \"0x00000000000000ffffffee\"\n         %-1.5x :, \"00000\", \"0007b\", \"ffffffee\"\n          %1.5x :, \"00000\", \"0007b\", \"ffffffee\"\n       %-#01.5x :, \"00000\", \"0x0007b\", \"0xffffffee\"\n        %-#1.5x :, \"00000\", \"0x0007b\", \"0xffffffee\"\n         %-#.5x :, \"00000\", \"0x0007b\", \"0xffffffee\"\n         %-#1.x :, \" \", \"0x7b\", \"0xffffffee\"\n          %-#.x :, \"\", \"0x7b\", \"0xffffffee\"");
#endif
  
  printf("#%.4x %4x#\n", 4, 88);
  printf("#%4x#\n",4);
#ifndef YALIBCT_DISABLE_PRINTF_HASH_FLAG_TESTS
  printf("#%#22.8x#\n",1234567);
#else
  puts("#            0x0012d687#");
#endif
  
  printf("#%+2i#\n",18);
  printf("#%i#\n",18);
  printf("#%llu#\n",4294967297ULL);
  printf("#%#x#\n",44444);
  printf("#%-8i#\n",33);
  printf("#%i#\n",18);
  printf("#%d#\n",18);
  printf("#%u#\n",18);
  printf("#%lu#\n",18);
  printf("#%li#\n",18);
  printf("#%-+#06d#\n", -123);
  printf("#%-+#6d#\n", -123);
  printf("#%+#06d#\n", -123);
  printf("#%06d#\n", -123);
  printf("#%+15s#\n","ABCDEF");
  /* from ncurses make_keys */
  printf("{ %4d, %-*.*s },\t/* %s */\n", 139, 16, 16, "KEY_A1", "key_a1");
  printf("{ %4d, %-*.*s },\t/* %s */\n", 139, 16,  2, "KEY_A1", "key_a1");
  printf("{ %4d, %-*.*s },\t/* %s */\n", 139,  2, 16, "KEY_A1", "key_a1");
  printf("{ %4d, %-*.*s },\t/* %s */\n", 139, 16,  0, "KEY_A1", "key_a1");
  printf("{ %4d, %-*.*s },\t/* %s */\n", 139,  0, 16, "KEY_A1", "key_a1");
  printf("{ %4d, %-*.*s },\t/* %s */\n", 139,  0,  0, "KEY_A1", "key_a1");
  printf("{ %4d, %*.*s },\t/* %s */\n", 139, 16, 16, "KEY_A1", "key_a1");
  printf("{ %4d, %*.*s },\t/* %s */\n", 139, 16,  2, "KEY_A1", "key_a1");
  printf("{ %4d, %*.*s },\t/* %s */\n", 139,  2, 16, "KEY_A1", "key_a1");
  printf("{ %4d, %*.*s },\t/* %s */\n", 139, 16,  0, "KEY_A1", "key_a1");
  printf("{ %4d, %*.*s },\t/* %s */\n", 139,  0, 16, "KEY_A1", "key_a1");
  printf("{ %4d, %*.*s },\t/* %s */\n", 139,  0,  0, "KEY_A1", "key_a1");
  printf("%*.*f\n",  0, 16, 0.0);
  printf("%*.*f\n", 16, 16, 0.0);
#ifndef YALIBCT_DISABLE_PRINTF_PRECISION_TESTS
  printf("%*.*f\n",  2, 2,  -0.0);
#else
  puts("-0.00");
#endif
  printf("%*.*f\n", 20, 0,  -123.123);
  printf("%*.*f\n", 10, 0,  +123.123);
  
  
  i = printf("\"%s\"\n","A");
  printf("%i\n", i); 
  /* from glibc's tst-printf.c */
  
  {
    char buf[20];
    char buf2[512];
    int i;

    printf ("snprintf (\"%%30s\", \"foo\") == %d, \"%.*s\"\n",
	    snprintf (buf, sizeof (buf), "%30s", "foo"), (int) sizeof (buf),
	    buf);
    memset(buf2,0,sizeof(buf));
    i=snprintf(buf2, 256, "%.9999u", 10);
    printf("%i %i\n",i,strlen(buf2));
    
#ifndef YALIBCT_DISABLE_PRINTF_PRECISION_TESTS
    printf ("snprintf (\"%%.999999u\", 10) == %d\n",
    	    snprintf(buf2, sizeof(buf2), "%.999999u", 10));
#else
    puts("snprintf (\"%.999999u\", 10) == 999999");
#endif
  }
  return 0;
}
